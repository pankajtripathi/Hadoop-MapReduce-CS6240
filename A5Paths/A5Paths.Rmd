---
title: "A5 Paths Report"
author: "Pankaj Tripathi, Kartik Mahaley"
date: "March 09, 2016"
output: pdf_document
---

This is a report generated from R and it has the required results of our assignment A5.

__INTRODUCTION:__
This assignment is to display number of connections and missed connection between flights of same airline for same year. We have written mapreduce chain job to accomplish the same.

__DESIGN:__
We have taken each row and divinded it into two records for departing and arrival flights.
Our Mapper takes key as carrier year and destination/origin airport. If key contains origin airport
then corresponding value is false with departure details. If key contains destination airport then corresponding value is true and arrival details.

__IMPLEMENTATION:__
Our code includes chain mapreduce with map1-reduce1-map2-reduce2. 1st mapreduce job creates intermediate files with key as carrier, year, airport(destination/origin). This intermediate files are then taken by job2 to combine all the files generated by job1 and produces final output for airline, year and connections/missedconnections.
The conditions checked for connection flight and missed flight is given below.
  1. Any pair of flight F and G of the same carrier such as F.Destination = G.Origin.
  2. The scheduled departure of G is  <= 6 hours and >= 30 minutes after the scheduled arrival of F.
  3. A connection is missed when the actual arrival of F < 30 minutes before the actual departure of G.

__PERFORMANCE:__
As per our analysis for 653 MB gzipped data(25 files) on i5-8gb Mac machine and 653MB on i5-8gb Linux machine pesudo mode takes 150 mins and on cluster it takes 30 mins with 1:10 m3 xlarge machine. 


__GRPAHS:__

```{r echo = FALSE}
dat <- read.table(text = "YV F9 AS DL FL OO UA US HA EV 9E B6 WN AA MQ VX
1 84339 47042 71811 1451961 141700 703849 587238 470963 21126 1224970 305461 160707 715508 1021082 703178 15307
2 1334375 1066511 1599612 42720518 2626005 12298498 11612851 12095764 992047 19121080 6071667 2751230 23494241 22494448 11377156 340526", header = TRUE)

library(reshape2)

dat$row <- seq_len(nrow(dat))
dat2 <- melt(dat, id.vars = "row")

library(ggplot2)

ggplot(dat2, aes(x=variable, y=log(value), fill=row)) + 
  geom_bar(stat="identity") +
  xlab("\nCarrier(Year = 2013)") +
  ylab("Connections in log scale\n") +
  guides(fill=FALSE) +
  theme_bw()
```


```{r echo = FALSE}
dat <- read.table(text = "VX F9 AS DL FL OO UA US HA EV B6 WN AA MQ
1 14625 64424 78040 228076 38942 579836 664421 557624 25334 1189046 132575 1125962 1082175 706966
2 336469 1019767 1703474 5391435 832145 9717323 11231315 12019446 1034607 15266696 1782809 27355347 21307342 9115791", header = TRUE)

library(reshape2)

dat$row <- seq_len(nrow(dat))
dat2 <- melt(dat, id.vars = "row")

library(ggplot2)

ggplot(dat2, aes(x=variable, y=log(value), fill=row)) + 
  geom_bar(stat="identity") +
  xlab("\nCarrier(Year = 2014)") +
  ylab("Connections in log scale\n") +
  guides(fill=FALSE) +
  theme_bw()
```


```{r echo = FALSE}
dat <- read.table(text = "VX F9 AS DL FL OO UA US HA EV B6 WN AA MQ
1 1079 3232 2092 111246 58148 48047 1863 47608 2918 44515 18579 93360 88156 58709
2 24143 38340 29849 3691705 811559 798791 30163 945919 89791 645163 231827 2251474 1741092 695859", header = TRUE)

library(reshape2)

dat$row <- seq_len(nrow(dat))
dat2 <- melt(dat, id.vars = "row")

library(ggplot2)

ggplot(dat2, aes(x=variable, y=log(value), fill=row)) + 
  geom_bar(stat="identity") +
  xlab("\nCarrier(Year = 2015)") +
  ylab("Connections in log scale\n") +
  guides(fill=FALSE) +
  theme_bw()
```

```{r echo = FALSE}
runs <- c(30, 33, 28, 148, 150, 149)
barplot(runs, main="Run Time", names.arg=c("AWS-1","AWS-2","AWS-3","Pseudo1","Pseudo2","Pseudo3"),  border="blue")
```